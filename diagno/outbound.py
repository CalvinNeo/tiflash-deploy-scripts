import re
import sys
import json

PAT = r'''.*MPPTaskStatistics.cpp.*\[\"(.*)\"\] \[source'''

S = r'''
[2024/05/13 11:55:40.227 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":6,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_53\",\"executors\":[{\"id\":\"ExchangeReceiver_52\",\"type\":\"ExchangeReceiver\",\"children\":[],\"outbound_rows\":2311194,\"outbound_blocks\":37,\"outbound_bytes\":78932555,\"outbound_allocated_bytes\":146407424,\"concurrency\":16,\"execution_time_ns\":3399916317,\"partition_num\":3,\"receiver_source_task_ids\":[1,2,3],\"connection_details\":[{\"receiver_source_task_id\":1,\"packets\":19,\"bytes\":19576379},{\"receiver_source_task_id\":2,\"packets\":7,\"bytes\":6985542},{\"receiver_source_task_id\":3,\"packets\":11,\"bytes\":17510125}]},{\"id\":\"ExchangeSender_53\",\"type\":\"ExchangeSender\",\"children\":[\"HashJoin_47\"],\"outbound_rows\":4218535,\"outbound_blocks\":197,\"outbound_bytes\":1305632966,\"outbound_allocated_bytes\":1548616704,\"concurrency\":16,\"execution_time_ns\":14909633023,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel6+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":140,\"bytes\":46855679},{\"tunnel_id\":\"tunnel6+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":140,\"bytes\":46852364},{\"tunnel_id\":\"tunnel6+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":140,\"bytes\":414332116}]},{\"id\":\"HashJoin_47\",\"type\":\"Join\",\"children\":[\"TableFullScan_48\",\"ExchangeReceiver_52\"],\"outbound_rows\":4218535,\"outbound_blocks\":197,\"outbound_bytes\":1305632966,\"outbound_allocated_bytes\":1548616704,\"concurrency\":16,\"execution_time_ns\":8589788578,\"peak_build_bytes_usage\":0,\"build_side_child\":\"ExchangeReceiver_52\",\"is_spill_enabled\":false,\"is_spilled\":false,\"join_build_inbound_rows\":2311194,\"join_build_inbound_blocks\":37,\"join_build_inbound_bytes\":118222853,\"join_build_inbound_allocated_bytes\":221857941,\"join_build_concurrency\":16,\"join_build_execution_time_ns\":3509913609},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":4218535,\"outbound_blocks\":197,\"outbound_bytes\":1155878590,\"outbound_allocated_bytes\":1370551808,\"concurrency\":16,\"execution_time_ns\":8489791038,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":1155878590},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"57.053ms\",\"create_snapshot_time\":\"0.100ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"2056.274ms\",\"dmfile_scan_rows\":17611168,\"dmfile_skip_rows\":31024572,\"late_materialization_skip_rows\":24576,\"learner_read_time\":\"13.114ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":20,\"num_read_tasks\":25,\"num_segments\":25,\"read_bytes\":1262332298,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325299935000,\"task_start_timestamp\":1715601325322650000,\"task_end_timestamp\":1715601340227725000,\"compile_start_timestamp\":1715601325300395000,\"compile_end_timestamp\":1715601325322583000,\"read_wait_index_start_timestamp\":1715601325308258000,\"read_wait_index_end_timestamp\":1715601325321263000,\"local_input_bytes\":1155878590,\"remote_input_bytes\":78932555,\"output_bytes\":1305632966,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":3023.3333333333335,\"read_ru\":19261.66226196289,\"memory_peak\":7057127053}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:6>"] [thread_id=1493]
[2024/05/13 11:55:38.268 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":4,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_53\",\"executors\":[{\"id\":\"ExchangeReceiver_52\",\"type\":\"ExchangeReceiver\",\"children\":[],\"outbound_rows\":2311194,\"outbound_blocks\":37,\"outbound_bytes\":78932555,\"outbound_allocated_bytes\":146407424,\"concurrency\":16,\"execution_time_ns\":2789953828,\"partition_num\":3,\"receiver_source_task_ids\":[1,2,3],\"connection_details\":[{\"receiver_source_task_id\":1,\"packets\":20,\"bytes\":31681597},{\"receiver_source_task_id\":2,\"packets\":8,\"bytes\":6985542},{\"receiver_source_task_id\":3,\"packets\":12,\"bytes\":10834897}]},{\"id\":\"ExchangeSender_53\",\"type\":\"ExchangeSender\",\"children\":[\"HashJoin_47\"],\"outbound_rows\":4173454,\"outbound_blocks\":182,\"outbound_bytes\":1291737607,\"outbound_allocated_bytes\":1525886976,\"concurrency\":16,\"execution_time_ns\":9489841734,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel4+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":135,\"bytes\":407805288},{\"tunnel_id\":\"tunnel4+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":135,\"bytes\":46334019},{\"tunnel_id\":\"tunnel4+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":135,\"bytes\":46651124}]},{\"id\":\"HashJoin_47\",\"type\":\"Join\",\"children\":[\"TableFullScan_48\",\"ExchangeReceiver_52\"],\"outbound_rows\":4173454,\"outbound_blocks\":182,\"outbound_bytes\":1291737607,\"outbound_allocated_bytes\":1525886976,\"concurrency\":16,\"execution_time_ns\":4149931174,\"peak_build_bytes_usage\":0,\"build_side_child\":\"ExchangeReceiver_52\",\"is_spill_enabled\":false,\"is_spilled\":false,\"join_build_inbound_rows\":2311194,\"join_build_inbound_blocks\":37,\"join_build_inbound_bytes\":118222853,\"join_build_inbound_allocated_bytes\":221857941,\"join_build_concurrency\":16,\"join_build_execution_time_ns\":2879952339},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":4173454,\"outbound_blocks\":182,\"outbound_bytes\":1143526396,\"outbound_allocated_bytes\":1348175872,\"concurrency\":16,\"execution_time_ns\":3979934009,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":1143526396},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"14.131ms\",\"create_snapshot_time\":\"0.156ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"2015.912ms\",\"dmfile_scan_rows\":17156684,\"dmfile_skip_rows\":31361786,\"late_materialization_skip_rows\":8192,\"learner_read_time\":\"24.640ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":20,\"num_read_tasks\":28,\"num_segments\":28,\"read_bytes\":1240750682,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325300824000,\"task_start_timestamp\":1715601325328226000,\"task_end_timestamp\":1715601338268820000,\"compile_start_timestamp\":1715601325301422000,\"compile_end_timestamp\":1715601325328174000,\"read_wait_index_start_timestamp\":1715601325302242000,\"read_wait_index_end_timestamp\":1715601325326780000,\"local_input_bytes\":1143526396,\"remote_input_bytes\":78932555,\"output_bytes\":1291737607,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":3060,\"read_ru\":18932.352935791016,\"memory_peak\":4449238748}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:4>"] [thread_id=1387]
[2024/05/13 11:55:38.400 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":5,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_53\",\"executors\":[{\"id\":\"ExchangeReceiver_52\",\"type\":\"ExchangeReceiver\",\"children\":[],\"outbound_rows\":2311194,\"outbound_blocks\":37,\"outbound_bytes\":78932555,\"outbound_allocated_bytes\":146407424,\"concurrency\":16,\"execution_time_ns\":2289990564,\"partition_num\":3,\"receiver_source_task_ids\":[1,2,3],\"connection_details\":[{\"receiver_source_task_id\":1,\"packets\":19,\"bytes\":19576379},{\"receiver_source_task_id\":2,\"packets\":7,\"bytes\":11256017},{\"receiver_source_task_id\":3,\"packets\":11,\"bytes\":10834897}]},{\"id\":\"ExchangeSender_53\",\"type\":\"ExchangeSender\",\"children\":[\"HashJoin_47\"],\"outbound_rows\":4181940,\"outbound_blocks\":181,\"outbound_bytes\":1294376349,\"outbound_allocated_bytes\":1547864064,\"concurrency\":16,\"execution_time_ns\":12939946678,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel5+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":139,\"bytes\":46514894},{\"tunnel_id\":\"tunnel5+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":139,\"bytes\":408897580},{\"tunnel_id\":\"tunnel5+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":139,\"bytes\":46753479}]},{\"id\":\"HashJoin_47\",\"type\":\"Join\",\"children\":[\"TableFullScan_48\",\"ExchangeReceiver_52\"],\"outbound_rows\":4181940,\"outbound_blocks\":181,\"outbound_bytes\":1294376349,\"outbound_allocated_bytes\":1547864064,\"concurrency\":16,\"execution_time_ns\":3879984012,\"peak_build_bytes_usage\":0,\"build_side_child\":\"ExchangeReceiver_52\",\"is_spill_enabled\":false,\"is_spilled\":false,\"join_build_inbound_rows\":2311194,\"join_build_inbound_blocks\":37,\"join_build_inbound_bytes\":118222853,\"join_build_inbound_allocated_bytes\":221857941,\"join_build_concurrency\":16,\"join_build_execution_time_ns\":2389990152},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":4181940,\"outbound_blocks\":181,\"outbound_bytes\":1145851560,\"outbound_allocated_bytes\":1368574976,\"concurrency\":16,\"execution_time_ns\":3549985371,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":1145851560},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"11.665ms\",\"create_snapshot_time\":\"0.094ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"1873.175ms\",\"dmfile_scan_rows\":17377206,\"dmfile_skip_rows\":27150198,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"12.848ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":20,\"num_read_tasks\":25,\"num_segments\":25,\"read_bytes\":1237380852,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325299747000,\"task_start_timestamp\":1715601325315239000,\"task_end_timestamp\":1715601338400677000,\"compile_start_timestamp\":1715601325300069000,\"compile_end_timestamp\":1715601325315225000,\"read_wait_index_start_timestamp\":1715601325301229000,\"read_wait_index_end_timestamp\":1715601325313995000,\"local_input_bytes\":1145851560,\"remote_input_bytes\":78932555,\"output_bytes\":1294376349,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":3033.3333333333335,\"read_ru\":18880.93341064453,\"memory_peak\":4732716695}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:5>"] [thread_id=1388]
[2024/05/13 11:55:33.728 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":12,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_71\",\"executors\":[{\"id\":\"ExchangeSender_71\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_59\"],\"outbound_rows\":594494,\"outbound_blocks\":256,\"outbound_bytes\":102252968,\"outbound_allocated_bytes\":128238840,\"concurrency\":16,\"execution_time_ns\":8409793006,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel12+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":12,\"bytes\":8112920},{\"tunnel_id\":\"tunnel12+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":15,\"bytes\":7615582},{\"tunnel_id\":\"tunnel12+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":19,\"bytes\":34359596}]},{\"id\":\"HashAgg_59\",\"type\":\"Agg\",\"children\":[\"Projection_182\"],\"outbound_rows\":594494,\"outbound_blocks\":256,\"outbound_bytes\":99874992,\"outbound_allocated_bytes\":125829120,\"concurrency\":16,\"execution_time_ns\":8389793498},{\"id\":\"Projection_182\",\"type\":\"Projection\",\"children\":[\"Selection_68\"],\"outbound_rows\":4735498,\"outbound_blocks\":93,\"outbound_bytes\":303071872,\"outbound_allocated_bytes\":526916592,\"concurrency\":16,\"execution_time_ns\":6319844446},{\"id\":\"Selection_68\",\"type\":\"Selection\",\"children\":[\"TableFullScan_67\"],\"outbound_rows\":4735498,\"outbound_blocks\":93,\"outbound_bytes\":303071872,\"outbound_allocated_bytes\":558891008,\"concurrency\":16,\"execution_time_ns\":6319844446},{\"id\":\"TableFullScan_67\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5812295,\"outbound_blocks\":93,\"outbound_bytes\":371986880,\"outbound_allocated_bytes\":724566016,\"concurrency\":16,\"execution_time_ns\":6299844938,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":371986880},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"1.306ms\",\"create_snapshot_time\":\"0.054ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"605.323ms\",\"dmfile_scan_rows\":5820487,\"dmfile_skip_rows\":781422,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"16.138ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":6,\"num_read_tasks\":9,\"num_segments\":9,\"read_bytes\":372126144,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325304351000,\"task_start_timestamp\":1715601325322799000,\"task_end_timestamp\":1715601333728052000,\"compile_start_timestamp\":1715601325304677000,\"compile_end_timestamp\":1715601325322784000,\"read_wait_index_start_timestamp\":1715601325305092000,\"read_wait_index_end_timestamp\":1715601325321193000,\"local_input_bytes\":371986880,\"remote_input_bytes\":0,\"output_bytes\":102252968,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":970,\"read_ru\":5678.1943359375,\"memory_peak\":3316451449}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:12>"] [thread_id=1425]
[2024/05/13 11:55:28.750 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":9,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_56\",\"executors\":[{\"id\":\"ExchangeSender_56\",\"type\":\"ExchangeSender\",\"children\":[\"TableFullScan_55\"],\"outbound_rows\":1040984,\"outbound_blocks\":52,\"outbound_bytes\":41164477,\"outbound_allocated_bytes\":49429632,\"concurrency\":16,\"execution_time_ns\":3439915332,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel9+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":6507611},{\"tunnel_id\":\"tunnel9+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":6530609},{\"tunnel_id\":\"tunnel9+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":18,\"bytes\":10995663}]},{\"id\":\"TableFullScan_55\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":1040984,\"outbound_blocks\":52,\"outbound_bytes\":41164477,\"outbound_allocated_bytes\":49429632,\"concurrency\":16,\"execution_time_ns\":3409916070,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":41164477},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"96.690ms\",\"create_snapshot_time\":\"0.050ms\",\"delta_bytes\":8948465,\"delta_rows\":14679,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"180.530ms\",\"dmfile_scan_rows\":2129172,\"dmfile_skip_rows\":2347660,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.979ms\",\"local_region_num\":0,\"mvcc_input_bytes\":17814487,\"mvcc_input_rows\":1047911,\"mvcc_skip_rows\":6927,\"num_columns\":5,\"num_read_tasks\":5,\"num_segments\":5,\"read_bytes\":60356234,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325299934000,\"task_start_timestamp\":1715601325306102000,\"task_end_timestamp\":1715601328750453000,\"compile_start_timestamp\":1715601325300244000,\"compile_end_timestamp\":1715601325306085000,\"read_wait_index_start_timestamp\":1715601325300338000,\"read_wait_index_end_timestamp\":1715601325302301000,\"local_input_bytes\":41164477,\"remote_input_bytes\":0,\"output_bytes\":41164477,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":50,\"read_ru\":920.9630432128906,\"memory_peak\":1906616236}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:9>"] [thread_id=1385]
[2024/05/13 11:55:28.366 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":10,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_71\",\"executors\":[{\"id\":\"ExchangeSender_71\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_59\"],\"outbound_rows\":586398,\"outbound_blocks\":256,\"outbound_bytes\":100860456,\"outbound_allocated_bytes\":128206456,\"concurrency\":16,\"execution_time_ns\":3029949857,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel10+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":11,\"bytes\":33651764},{\"tunnel_id\":\"tunnel10+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":13,\"bytes\":7172742},{\"tunnel_id\":\"tunnel10+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":14,\"bytes\":6703201}]},{\"id\":\"HashAgg_59\",\"type\":\"Agg\",\"children\":[\"Projection_182\"],\"outbound_rows\":586398,\"outbound_blocks\":256,\"outbound_bytes\":98514864,\"outbound_allocated_bytes\":125829120,\"concurrency\":16,\"execution_time_ns\":3019950022},{\"id\":\"Projection_182\",\"type\":\"Projection\",\"children\":[\"Selection_68\"],\"outbound_rows\":4495965,\"outbound_blocks\":92,\"outbound_bytes\":287741760,\"outbound_allocated_bytes\":504815208,\"concurrency\":16,\"execution_time_ns\":1629973025},{\"id\":\"Selection_68\",\"type\":\"Selection\",\"children\":[\"TableFullScan_67\"],\"outbound_rows\":4495965,\"outbound_blocks\":92,\"outbound_bytes\":287741760,\"outbound_allocated_bytes\":535822336,\"concurrency\":16,\"execution_time_ns\":1629973025},{\"id\":\"TableFullScan_67\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5642527,\"outbound_blocks\":92,\"outbound_bytes\":361121728,\"outbound_allocated_bytes\":711720960,\"concurrency\":16,\"execution_time_ns\":1629973025,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":361121728},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.482ms\",\"create_snapshot_time\":\"0.075ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"479.782ms\",\"dmfile_scan_rows\":5642527,\"dmfile_skip_rows\":0,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"26.179ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":6,\"num_read_tasks\":9,\"num_segments\":9,\"read_bytes\":361121728,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325299623000,\"task_start_timestamp\":1715601325328381000,\"task_end_timestamp\":1715601328366381000,\"compile_start_timestamp\":1715601325300042000,\"compile_end_timestamp\":1715601325328367000,\"read_wait_index_start_timestamp\":1715601325300564000,\"read_wait_index_end_timestamp\":1715601325326698000,\"local_input_bytes\":361121728,\"remote_input_bytes\":0,\"output_bytes\":100860456,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":976.6666666666666,\"read_ru\":5510.2802734375,\"memory_peak\":2598610347}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:10>"] [thread_id=1231]
[2024/05/13 11:55:27.221 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":11,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_71\",\"executors\":[{\"id\":\"ExchangeSender_71\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_59\"],\"outbound_rows\":558757,\"outbound_blocks\":256,\"outbound_bytes\":96106204,\"outbound_allocated_bytes\":128095892,\"concurrency\":16,\"execution_time_ns\":1919992089,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel11+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":10,\"bytes\":7282124},{\"tunnel_id\":\"tunnel11+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":16,\"bytes\":32184558},{\"tunnel_id\":\"tunnel11+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":16,\"bytes\":6882492}]},{\"id\":\"HashAgg_59\",\"type\":\"Agg\",\"children\":[\"Projection_182\"],\"outbound_rows\":558757,\"outbound_blocks\":256,\"outbound_bytes\":93871176,\"outbound_allocated_bytes\":125829120,\"concurrency\":16,\"execution_time_ns\":1899992171},{\"id\":\"Projection_182\",\"type\":\"Projection\",\"children\":[\"Selection_68\"],\"outbound_rows\":4015881,\"outbound_blocks\":81,\"outbound_bytes\":257016384,\"outbound_allocated_bytes\":452117096,\"concurrency\":16,\"execution_time_ns\":1629993284},{\"id\":\"Selection_68\",\"type\":\"Selection\",\"children\":[\"TableFullScan_67\"],\"outbound_rows\":4015881,\"outbound_blocks\":81,\"outbound_bytes\":257016384,\"outbound_allocated_bytes\":479985664,\"concurrency\":16,\"execution_time_ns\":1629993284},{\"id\":\"TableFullScan_67\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5003953,\"outbound_blocks\":81,\"outbound_bytes\":320252992,\"outbound_allocated_bytes\":633077760,\"concurrency\":16,\"execution_time_ns\":1619993326,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":320252992},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.497ms\",\"create_snapshot_time\":\"0.046ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"361.883ms\",\"dmfile_scan_rows\":5003953,\"dmfile_skip_rows\":8,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"12.704ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":6,\"num_read_tasks\":8,\"num_segments\":8,\"read_bytes\":320252992,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325300336000,\"task_start_timestamp\":1715601325315133000,\"task_end_timestamp\":1715601327221738000,\"compile_start_timestamp\":1715601325300604000,\"compile_end_timestamp\":1715601325315116000,\"read_wait_index_start_timestamp\":1715601325300977000,\"read_wait_index_end_timestamp\":1715601325313659000,\"local_input_bytes\":320252992,\"remote_input_bytes\":0,\"output_bytes\":96106204,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":863.3333333333334,\"read_ru\":4886.6728515625,\"memory_peak\":1427186712}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:11>"] [thread_id=1238]
[2024/05/13 11:55:26.505 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":8,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_56\",\"executors\":[{\"id\":\"ExchangeSender_56\",\"type\":\"ExchangeSender\",\"children\":[\"TableFullScan_55\"],\"outbound_rows\":1004806,\"outbound_blocks\":60,\"outbound_bytes\":39736065,\"outbound_allocated_bytes\":51811104,\"concurrency\":16,\"execution_time_ns\":1209995014,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel8+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":6204741},{\"tunnel_id\":\"tunnel8+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":19,\"bytes\":10612736},{\"tunnel_id\":\"tunnel8+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":19,\"bytes\":6226247}]},{\"id\":\"TableFullScan_55\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":1004806,\"outbound_blocks\":60,\"outbound_bytes\":39736065,\"outbound_allocated_bytes\":51811104,\"concurrency\":16,\"execution_time_ns\":1189995097,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":39736065},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"51.143ms\",\"create_snapshot_time\":\"0.056ms\",\"delta_bytes\":10196287,\"delta_rows\":16726,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"74.665ms\",\"dmfile_scan_rows\":2052356,\"dmfile_skip_rows\":3454972,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.983ms\",\"local_region_num\":0,\"mvcc_input_bytes\":17199087,\"mvcc_input_rows\":1011711,\"mvcc_skip_rows\":6905,\"num_columns\":5,\"num_read_tasks\":6,\"num_segments\":6,\"read_bytes\":58149172,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325300348000,\"task_start_timestamp\":1715601325305135000,\"task_end_timestamp\":1715601326505737000,\"compile_start_timestamp\":1715601325300525000,\"compile_end_timestamp\":1715601325305120000,\"read_wait_index_start_timestamp\":1715601325300623000,\"read_wait_index_end_timestamp\":1715601325302591000,\"local_input_bytes\":39736065,\"remote_input_bytes\":0,\"output_bytes\":39736065,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":43.333333333333336,\"read_ru\":887.2859497070312,\"memory_peak\":1173035966}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:8>"] [thread_id=1354]
[2024/05/13 11:55:27.245 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":3,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_51\",\"executors\":[{\"id\":\"ExchangeSender_51\",\"type\":\"ExchangeSender\",\"children\":[\"TableFullScan_50\"],\"outbound_rows\":669527,\"outbound_blocks\":11,\"outbound_bytes\":22864935,\"outbound_allocated_bytes\":42598400,\"concurrency\":16,\"execution_time_ns\":1929952497,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Broadcast\",\"connection_details\":[{\"tunnel_id\":\"tunnel3+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":11,\"bytes\":10834897},{\"tunnel_id\":\"tunnel3+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":11,\"bytes\":10834897},{\"tunnel_id\":\"tunnel3+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":11,\"bytes\":17510125}]},{\"id\":\"TableFullScan_50\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":669527,\"outbound_blocks\":11,\"outbound_bytes\":22864935,\"outbound_allocated_bytes\":42598400,\"concurrency\":16,\"execution_time_ns\":1919952743,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":22864935},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.046ms\",\"create_snapshot_time\":\"0.013ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"68.146ms\",\"dmfile_scan_rows\":669527,\"dmfile_skip_rows\":203986,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.700ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":3,\"num_read_tasks\":1,\"num_segments\":1,\"read_bytes\":22864935,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325304884000,\"task_start_timestamp\":1715601325307093000,\"task_end_timestamp\":1715601327245006000,\"compile_start_timestamp\":1715601325305045000,\"compile_end_timestamp\":1715601325307080000,\"read_wait_index_start_timestamp\":1715601325305101000,\"read_wait_index_end_timestamp\":1715601325306796000,\"local_input_bytes\":22864935,\"remote_input_bytes\":0,\"output_bytes\":22864935,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":40,\"read_ru\":348.89122009277344,\"memory_peak\":351766928}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:3>"] [thread_id=910]
[2024/05/13 11:55:26.449 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":7,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_56\",\"executors\":[{\"id\":\"ExchangeSender_56\",\"type\":\"ExchangeSender\",\"children\":[\"TableFullScan_55\"],\"outbound_rows\":958494,\"outbound_blocks\":49,\"outbound_bytes\":37895854,\"outbound_allocated_bytes\":50668992,\"concurrency\":16,\"execution_time_ns\":1139981133,\"partition_num\":3,\"sender_target_task_ids\":[13,14,15],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel7+13\",\"sender_target_task_id\":13,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":18,\"bytes\":10137883},{\"tunnel_id\":\"tunnel7+14\",\"sender_target_task_id\":14,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":5965188},{\"tunnel_id\":\"tunnel7+15\",\"sender_target_task_id\":15,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":5946307}]},{\"id\":\"TableFullScan_55\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":958494,\"outbound_blocks\":49,\"outbound_bytes\":37895854,\"outbound_allocated_bytes\":50668992,\"concurrency\":16,\"execution_time_ns\":1129981299,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":37895854},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"78.818ms\",\"create_snapshot_time\":\"0.066ms\",\"delta_bytes\":11499616,\"delta_rows\":18864,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"96.834ms\",\"dmfile_scan_rows\":1916990,\"dmfile_skip_rows\":4091576,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"14.919ms\",\"local_region_num\":0,\"mvcc_input_bytes\":16370949,\"mvcc_input_rows\":962997,\"mvcc_skip_rows\":4503,\"num_columns\":5,\"num_read_tasks\":6,\"num_segments\":6,\"read_bytes\":54310214,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325300656000,\"task_start_timestamp\":1715601325317639000,\"task_end_timestamp\":1715601326449808000,\"compile_start_timestamp\":1715601325301743000,\"compile_end_timestamp\":1715601325317621000,\"read_wait_index_start_timestamp\":1715601325301842000,\"read_wait_index_end_timestamp\":1715601325316741000,\"local_input_bytes\":37895854,\"remote_input_bytes\":0,\"output_bytes\":37895854,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":46.666666666666664,\"read_ru\":828.7080993652344,\"memory_peak\":1207414700}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:7>"] [thread_id=1317]
[2024/05/13 11:55:25.993 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":1,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_51\",\"executors\":[{\"id\":\"ExchangeSender_51\",\"type\":\"ExchangeSender\",\"children\":[\"TableFullScan_50\"],\"outbound_rows\":1211602,\"outbound_blocks\":20,\"outbound_bytes\":41371979,\"outbound_allocated_bytes\":77135872,\"concurrency\":16,\"execution_time_ns\":639989409,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Broadcast\",\"connection_details\":[{\"tunnel_id\":\"tunnel1+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":19,\"bytes\":31681597},{\"tunnel_id\":\"tunnel1+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":19,\"bytes\":19576379},{\"tunnel_id\":\"tunnel1+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":19,\"bytes\":19576379}]},{\"id\":\"TableFullScan_50\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":1211602,\"outbound_blocks\":20,\"outbound_bytes\":41371979,\"outbound_allocated_bytes\":77135872,\"concurrency\":16,\"execution_time_ns\":629989574,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":41371979},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.147ms\",\"create_snapshot_time\":\"0.049ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"65.000ms\",\"dmfile_scan_rows\":1211602,\"dmfile_skip_rows\":669527,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"0.889ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":3,\"num_read_tasks\":2,\"num_segments\":2,\"read_bytes\":41371979,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325300261000,\"task_start_timestamp\":1715601325306497000,\"task_end_timestamp\":1715601325993052000,\"compile_start_timestamp\":1715601325300440000,\"compile_end_timestamp\":1715601325306466000,\"read_wait_index_start_timestamp\":1715601325300521000,\"read_wait_index_end_timestamp\":1715601325301401000,\"local_input_bytes\":41371979,\"remote_input_bytes\":0,\"output_bytes\":41371979,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":53.333333333333336,\"read_ru\":631.2863006591797,\"memory_peak\":721112533}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:1>"] [thread_id=1306]
[2024/05/13 11:55:25.980 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734593807908870,\"task_id\":2,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_51\",\"executors\":[{\"id\":\"ExchangeSender_51\",\"type\":\"ExchangeSender\",\"children\":[\"TableFullScan_50\"],\"outbound_rows\":430065,\"outbound_blocks\":7,\"outbound_bytes\":14695641,\"outbound_allocated_bytes\":27262976,\"concurrency\":16,\"execution_time_ns\":659997281,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Broadcast\",\"connection_details\":[{\"tunnel_id\":\"tunnel2+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":7,\"bytes\":6985542},{\"tunnel_id\":\"tunnel2+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":7,\"bytes\":11256017},{\"tunnel_id\":\"tunnel2+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":7,\"bytes\":6985542}]},{\"id\":\"TableFullScan_50\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":430065,\"outbound_blocks\":7,\"outbound_bytes\":14695641,\"outbound_allocated_bytes\":27262976,\"concurrency\":16,\"execution_time_ns\":639997363,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":14695641},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.028ms\",\"create_snapshot_time\":\"0.014ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"15.916ms\",\"dmfile_scan_rows\":430065,\"dmfile_skip_rows\":0,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.264ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":3,\"num_read_tasks\":1,\"num_segments\":1,\"read_bytes\":14695641,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601325299654000,\"task_start_timestamp\":1715601325304165000,\"task_end_timestamp\":1715601325980247000,\"compile_start_timestamp\":1715601325299820000,\"compile_end_timestamp\":1715601325304148000,\"read_wait_index_start_timestamp\":1715601325299896000,\"read_wait_index_end_timestamp\":1715601325301154000,\"local_input_bytes\":14695641,\"remote_input_bytes\":0,\"output_bytes\":14695641,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":16.666666666666668,\"read_ru\":224.23768615722656,\"memory_peak\":796223787}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601325291339638, local_query_id:19521, server_id:171, start_ts:449734593807908870, resource_group: default>,task_id:2>"] [thread_id=1264]
'''

S = r'''
[2024/05/13 11:55:50.514 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734597333483525,\"task_id\":3,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_64\",\"executors\":[{\"id\":\"ExchangeSender_64\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_60\"],\"outbound_rows\":2103976,\"outbound_blocks\":256,\"outbound_bytes\":406067368,\"outbound_allocated_bytes\":771466912,\"concurrency\":16,\"execution_time_ns\":11769710307,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel3+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":19,\"bytes\":26062036},{\"tunnel_id\":\"tunnel3+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":19,\"bytes\":26316843},{\"tunnel_id\":\"tunnel3+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":19,\"bytes\":130291981}]},{\"id\":\"HashAgg_60\",\"type\":\"Agg\",\"children\":[\"Projection_69\"],\"outbound_rows\":2103976,\"outbound_blocks\":256,\"outbound_bytes\":397651464,\"outbound_allocated_bytes\":763019264,\"concurrency\":16,\"execution_time_ns\":11659713014},{\"id\":\"Projection_69\",\"type\":\"Projection\",\"children\":[\"Selection_49\"],\"outbound_rows\":4735498,\"outbound_blocks\":93,\"outbound_bytes\":402517330,\"outbound_allocated_bytes\":710302704,\"concurrency\":16,\"execution_time_ns\":6879830665},{\"id\":\"Selection_49\",\"type\":\"Selection\",\"children\":[\"TableFullScan_48\"],\"outbound_rows\":4735498,\"outbound_blocks\":93,\"outbound_bytes\":402517330,\"outbound_allocated_bytes\":742277120,\"concurrency\":16,\"execution_time_ns\":6879830665},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5812295,\"outbound_blocks\":93,\"outbound_bytes\":494045075,\"outbound_allocated_bytes\":962969600,\"concurrency\":16,\"execution_time_ns\":6879830665,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":494045075},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"1.459ms\",\"create_snapshot_time\":\"0.068ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"832.485ms\",\"dmfile_scan_rows\":5820487,\"dmfile_skip_rows\":781422,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.535ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":10,\"num_read_tasks\":9,\"num_segments\":9,\"read_bytes\":494184339,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601338744663000,\"task_start_timestamp\":1715601338752731000,\"task_end_timestamp\":1715601350514222000,\"compile_start_timestamp\":1715601338745036000,\"compile_end_timestamp\":1715601338752710000,\"read_wait_index_start_timestamp\":1715601338745577000,\"read_wait_index_end_timestamp\":1715601338747057000,\"local_input_bytes\":494045075,\"remote_input_bytes\":0,\"output_bytes\":406067368,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":1846.6666666666667,\"read_ru\":7540.654586791992,\"memory_peak\":2956623188}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601338741802603, local_query_id:19509, server_id:570, start_ts:449734597333483525, resource_group: default>,task_id:3>"] [thread_id=1473]
[2024/05/13 11:55:41.901 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734597333483525,\"task_id\":2,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_64\",\"executors\":[{\"id\":\"ExchangeSender_64\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_60\"],\"outbound_rows\":1884634,\"outbound_blocks\":256,\"outbound_bytes\":363734362,\"outbound_allocated_bytes\":630424424,\"concurrency\":16,\"execution_time_ns\":3159986979,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel2+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":23345613},{\"tunnel_id\":\"tunnel2+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":18,\"bytes\":116190325},{\"tunnel_id\":\"tunnel2+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":23222450}]},{\"id\":\"HashAgg_60\",\"type\":\"Agg\",\"children\":[\"Projection_69\"],\"outbound_rows\":1884634,\"outbound_blocks\":256,\"outbound_bytes\":356195826,\"outbound_allocated_bytes\":622854144,\"concurrency\":16,\"execution_time_ns\":3119987144},{\"id\":\"Projection_69\",\"type\":\"Projection\",\"children\":[\"Selection_49\"],\"outbound_rows\":4015881,\"outbound_blocks\":81,\"outbound_bytes\":341349885,\"outbound_allocated_bytes\":609677928,\"concurrency\":16,\"execution_time_ns\":1849992377},{\"id\":\"Selection_49\",\"type\":\"Selection\",\"children\":[\"TableFullScan_48\"],\"outbound_rows\":4015881,\"outbound_blocks\":81,\"outbound_bytes\":341349885,\"outbound_allocated_bytes\":637546496,\"concurrency\":16,\"execution_time_ns\":1849992377},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5003953,\"outbound_blocks\":81,\"outbound_bytes\":425336005,\"outbound_allocated_bytes\":840888320,\"concurrency\":16,\"execution_time_ns\":1849992377,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":425336005},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.489ms\",\"create_snapshot_time\":\"0.056ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"781.725ms\",\"dmfile_scan_rows\":5003953,\"dmfile_skip_rows\":8,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"2.368ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":10,\"num_read_tasks\":8,\"num_segments\":8,\"read_bytes\":425336005,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601338744493000,\"task_start_timestamp\":1715601338752003000,\"task_end_timestamp\":1715601341901638000,\"compile_start_timestamp\":1715601338744861000,\"compile_end_timestamp\":1715601338751984000,\"read_wait_index_start_timestamp\":1715601338745378000,\"read_wait_index_end_timestamp\":1715601338747702000,\"local_input_bytes\":425336005,\"remote_input_bytes\":0,\"output_bytes\":363734362,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":1663.3333333333333,\"read_ru\":6490.112380981445,\"memory_peak\":2568194955}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601338741802603, local_query_id:19509, server_id:570, start_ts:449734597333483525, resource_group: default>,task_id:2>"] [thread_id=846]
[2024/05/13 11:55:41.889 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734597333483525,\"task_id\":1,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_64\",\"executors\":[{\"id\":\"ExchangeSender_64\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_60\"],\"outbound_rows\":2046927,\"outbound_blocks\":256,\"outbound_bytes\":395056911,\"outbound_allocated_bytes\":632851260,\"concurrency\":16,\"execution_time_ns\":3149947169,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel1+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":18,\"bytes\":126510552},{\"tunnel_id\":\"tunnel1+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":26222187},{\"tunnel_id\":\"tunnel1+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":25972446}]},{\"id\":\"HashAgg_60\",\"type\":\"Agg\",\"children\":[\"Projection_69\"],\"outbound_rows\":2046927,\"outbound_blocks\":256,\"outbound_bytes\":386869203,\"outbound_allocated_bytes\":624631808,\"concurrency\":16,\"execution_time_ns\":3069948511},{\"id\":\"Projection_69\",\"type\":\"Projection\",\"children\":[\"Selection_49\"],\"outbound_rows\":4495965,\"outbound_blocks\":92,\"outbound_bytes\":382157025,\"outbound_allocated_bytes\":680894056,\"concurrency\":16,\"execution_time_ns\":1699971488},{\"id\":\"Selection_49\",\"type\":\"Selection\",\"children\":[\"TableFullScan_48\"],\"outbound_rows\":4495965,\"outbound_blocks\":92,\"outbound_bytes\":382157025,\"outbound_allocated_bytes\":711901184,\"concurrency\":16,\"execution_time_ns\":1699971488},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5642527,\"outbound_blocks\":92,\"outbound_bytes\":479614795,\"outbound_allocated_bytes\":945516544,\"concurrency\":16,\"execution_time_ns\":1699971488,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":479614795},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.414ms\",\"create_snapshot_time\":\"0.080ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"773.242ms\",\"dmfile_scan_rows\":5642527,\"dmfile_skip_rows\":0,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.284ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":10,\"num_read_tasks\":9,\"num_segments\":9,\"read_bytes\":479614795,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601338744781000,\"task_start_timestamp\":1715601338751266000,\"task_end_timestamp\":1715601341889119000,\"compile_start_timestamp\":1715601338745293000,\"compile_end_timestamp\":1715601338751242000,\"read_wait_index_start_timestamp\":1715601338745866000,\"read_wait_index_end_timestamp\":1715601338747108000,\"local_input_bytes\":479614795,\"remote_input_bytes\":0,\"output_bytes\":395056911,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":1680,\"read_ru\":7318.34098815918,\"memory_peak\":2376735080}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601338741802603, local_query_id:19509, server_id:570, start_ts:449734597333483525, resource_group: default>,task_id:1>"] [thread_id=1365]
'''

S = r'''
[2024/05/13 11:56:23.352 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734605446840323,\"task_id\":3,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_64\",\"executors\":[{\"id\":\"ExchangeSender_64\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_60\"],\"outbound_rows\":2103976,\"outbound_blocks\":256,\"outbound_bytes\":406067368,\"outbound_allocated_bytes\":771466912,\"concurrency\":16,\"execution_time_ns\":13679661720,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel3+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":16,\"bytes\":27261204},{\"tunnel_id\":\"tunnel3+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":16,\"bytes\":26884462},{\"tunnel_id\":\"tunnel3+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":16,\"bytes\":130256929}]},{\"id\":\"HashAgg_60\",\"type\":\"Agg\",\"children\":[\"Projection_69\"],\"outbound_rows\":2103976,\"outbound_blocks\":256,\"outbound_bytes\":397651464,\"outbound_allocated_bytes\":763019264,\"concurrency\":16,\"execution_time_ns\":13609663451},{\"id\":\"Projection_69\",\"type\":\"Projection\",\"children\":[\"Selection_49\"],\"outbound_rows\":4735498,\"outbound_blocks\":93,\"outbound_bytes\":402517330,\"outbound_allocated_bytes\":710302704,\"concurrency\":16,\"execution_time_ns\":6389841987},{\"id\":\"Selection_49\",\"type\":\"Selection\",\"children\":[\"TableFullScan_48\"],\"outbound_rows\":4735498,\"outbound_blocks\":93,\"outbound_bytes\":402517330,\"outbound_allocated_bytes\":742277120,\"concurrency\":16,\"execution_time_ns\":6389841987},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5812295,\"outbound_blocks\":93,\"outbound_bytes\":494045075,\"outbound_allocated_bytes\":962969600,\"concurrency\":16,\"execution_time_ns\":6379842234,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":494045075},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"1.446ms\",\"create_snapshot_time\":\"0.047ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"792.653ms\",\"dmfile_scan_rows\":5820487,\"dmfile_skip_rows\":781422,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"2.354ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":10,\"num_read_tasks\":9,\"num_segments\":9,\"read_bytes\":494184339,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601369688369000,\"task_start_timestamp\":1715601369693373000,\"task_end_timestamp\":1715601383352047000,\"compile_start_timestamp\":1715601369688714000,\"compile_end_timestamp\":1715601369693354000,\"read_wait_index_start_timestamp\":1715601369689187000,\"read_wait_index_end_timestamp\":1715601369691505000,\"local_input_bytes\":494045075,\"remote_input_bytes\":0,\"output_bytes\":406067368,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":1696.6666666666667,\"read_ru\":7540.654586791992,\"memory_peak\":3111990372}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601369685586923, local_query_id:19538, server_id:171, start_ts:449734605446840323, resource_group: default>,task_id:3>"] [thread_id=1158]
[2024/05/13 11:56:13.128 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734605446840323,\"task_id\":1,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_64\",\"executors\":[{\"id\":\"ExchangeSender_64\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_60\"],\"outbound_rows\":2046927,\"outbound_blocks\":256,\"outbound_bytes\":395056911,\"outbound_allocated_bytes\":632851260,\"concurrency\":16,\"execution_time_ns\":3469941801,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel1+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":18,\"bytes\":126510552},{\"tunnel_id\":\"tunnel1+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":24149973},{\"tunnel_id\":\"tunnel1+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":18,\"bytes\":24045616}]},{\"id\":\"HashAgg_60\",\"type\":\"Agg\",\"children\":[\"Projection_69\"],\"outbound_rows\":2046927,\"outbound_blocks\":256,\"outbound_bytes\":386869203,\"outbound_allocated_bytes\":624631808,\"concurrency\":16,\"execution_time_ns\":3379943311},{\"id\":\"Projection_69\",\"type\":\"Projection\",\"children\":[\"Selection_49\"],\"outbound_rows\":4495965,\"outbound_blocks\":92,\"outbound_bytes\":382157025,\"outbound_allocated_bytes\":680894056,\"concurrency\":16,\"execution_time_ns\":1219979539},{\"id\":\"Selection_49\",\"type\":\"Selection\",\"children\":[\"TableFullScan_48\"],\"outbound_rows\":4495965,\"outbound_blocks\":92,\"outbound_bytes\":382157025,\"outbound_allocated_bytes\":711901184,\"concurrency\":16,\"execution_time_ns\":1219979539},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5642527,\"outbound_blocks\":92,\"outbound_bytes\":479614795,\"outbound_allocated_bytes\":945516544,\"concurrency\":16,\"execution_time_ns\":1219979539,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":479614795},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.430ms\",\"create_snapshot_time\":\"0.077ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"827.135ms\",\"dmfile_scan_rows\":5642527,\"dmfile_skip_rows\":0,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.280ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":10,\"num_read_tasks\":9,\"num_segments\":9,\"read_bytes\":479614795,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601369688160000,\"task_start_timestamp\":1715601369692444000,\"task_end_timestamp\":1715601373128441000,\"compile_start_timestamp\":1715601369688542000,\"compile_end_timestamp\":1715601369692420000,\"read_wait_index_start_timestamp\":1715601369689065000,\"read_wait_index_end_timestamp\":1715601369690305000,\"local_input_bytes\":479614795,\"remote_input_bytes\":0,\"output_bytes\":395056911,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":1666.6666666666667,\"read_ru\":7318.34098815918,\"memory_peak\":2655776332}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601369685586923, local_query_id:19538, server_id:171, start_ts:449734605446840323, resource_group: default>,task_id:1>"] [thread_id=1003]
[2024/05/13 11:56:12.565 +00:00] [INFO] [MPPTaskStatistics.cpp:138] ["{\"query_tso\":449734605446840323,\"task_id\":2,\"is_root\":false,\"sender_executor_id\":\"ExchangeSender_64\",\"executors\":[{\"id\":\"ExchangeSender_64\",\"type\":\"ExchangeSender\",\"children\":[\"HashAgg_60\"],\"outbound_rows\":1884634,\"outbound_blocks\":256,\"outbound_bytes\":363734362,\"outbound_allocated_bytes\":630424424,\"concurrency\":16,\"execution_time_ns\":2879989009,\"partition_num\":3,\"sender_target_task_ids\":[4,5,6],\"exchange_type\":\"Hash\",\"connection_details\":[{\"tunnel_id\":\"tunnel2+4\",\"sender_target_task_id\":4,\"sender_target_host\":\"db-tiflash-1.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":19,\"bytes\":22648842},{\"tunnel_id\":\"tunnel2+5\",\"sender_target_task_id\":5,\"sender_target_host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":true,\"packets\":19,\"bytes\":116202011},{\"tunnel_id\":\"tunnel2+6\",\"sender_target_task_id\":6,\"sender_target_host\":\"db-tiflash-0.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"is_local\":false,\"packets\":19,\"bytes\":22745121}]},{\"id\":\"HashAgg_60\",\"type\":\"Agg\",\"children\":[\"Projection_69\"],\"outbound_rows\":1884634,\"outbound_blocks\":256,\"outbound_bytes\":356195826,\"outbound_allocated_bytes\":622854144,\"concurrency\":16,\"execution_time_ns\":2819989238},{\"id\":\"Projection_69\",\"type\":\"Projection\",\"children\":[\"Selection_49\"],\"outbound_rows\":4015881,\"outbound_blocks\":81,\"outbound_bytes\":341349885,\"outbound_allocated_bytes\":609677928,\"concurrency\":16,\"execution_time_ns\":1079995878},{\"id\":\"Selection_49\",\"type\":\"Selection\",\"children\":[\"TableFullScan_48\"],\"outbound_rows\":4015881,\"outbound_blocks\":81,\"outbound_bytes\":341349885,\"outbound_allocated_bytes\":637546496,\"concurrency\":16,\"execution_time_ns\":1079995878},{\"id\":\"TableFullScan_48\",\"type\":\"TableScan\",\"children\":[],\"outbound_rows\":5003953,\"outbound_blocks\":81,\"outbound_bytes\":425336005,\"outbound_allocated_bytes\":840888320,\"concurrency\":16,\"execution_time_ns\":1079995878,\"connection_details\":[{\"is_local\":true,\"packets\":0,\"bytes\":425336005},{\"is_local\":false,\"packets\":0,\"bytes\":0}],\"scan_details\":{\"build_bitmap_time\":\"0.543ms\",\"create_snapshot_time\":\"0.058ms\",\"delta_bytes\":0,\"delta_rows\":0,\"disagg_cache_hit_size\":0,\"disagg_cache_miss_size\":0,\"dmfile_read_time\":\"921.012ms\",\"dmfile_scan_rows\":5003953,\"dmfile_skip_rows\":8,\"late_materialization_skip_rows\":0,\"learner_read_time\":\"1.538ms\",\"local_region_num\":0,\"mvcc_input_bytes\":0,\"mvcc_input_rows\":0,\"mvcc_skip_rows\":0,\"num_columns\":10,\"num_read_tasks\":8,\"num_segments\":8,\"read_bytes\":425336005,\"read_mode\":\"Bitmap\",\"remote_region_num\":0}}],\"host\":\"db-tiflash-2.db-tiflash-peer.tidb1379661944646414735.svc:3930\",\"task_init_timestamp\":1715601369688368000,\"task_start_timestamp\":1715601369692895000,\"task_end_timestamp\":1715601372565888000,\"compile_start_timestamp\":1715601369688788000,\"compile_end_timestamp\":1715601369692830000,\"read_wait_index_start_timestamp\":1715601369689316000,\"read_wait_index_end_timestamp\":1715601369690818000,\"local_input_bytes\":425336005,\"remote_input_bytes\":0,\"output_bytes\":363734362,\"status\":\"FINISHED\",\"error_message\":\"\",\"cpu_ru\":1393.3333333333333,\"read_ru\":6490.112380981445,\"memory_peak\":2205887308}"] [source="mpp_task_tracing MPP<gather_id:<gather_id:1, query_ts:1715601369685586923, local_query_id:19538, server_id:171, start_ts:449734605446840323, resource_group: default>,task_id:2>"] [thread_id=1151]
'''

for l in S.split("\n"):
    encoded_jsons = re.findall(PAT, l)
    if not encoded_jsons:
        continue
    encoded_json = encoded_jsons[0]
    decoded_json = eval(f'"{encoded_json}"')
    j = json.loads(decoded_json)
    executors = j['executors']
    for e in executors:
        if e['id'].startswith("TableFull"):
            print ("{} {} {} {}".format(e['id'], e['outbound_rows'], e['execution_time_ns'], j['host'].split(".")[0]))